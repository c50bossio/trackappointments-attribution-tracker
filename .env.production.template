# BookingBridge Production Environment Configuration
# Copy this file to .env.production and fill in the actual values
# NEVER commit .env.production with real secrets to version control

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO
APP_NAME=BookingBridge Attribution Tracker
APP_VERSION=1.0.0
APP_URL=https://bookingbridge.com

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# Primary PostgreSQL Database
DATABASE_URL=postgresql://username:password@hostname:5432/bookingbridge_production
POSTGRES_DB=bookingbridge_production
POSTGRES_USER=bookingbridge_user
POSTGRES_PASSWORD=generate_secure_password_here
POSTGRES_HOST=db.production.internal
POSTGRES_PORT=5432

# Database Connection Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# Database SSL/Security
DATABASE_SSL_MODE=require
DATABASE_SSL_CERT_PATH=/etc/ssl/certs/postgresql.crt
DATABASE_SSL_KEY_PATH=/etc/ssl/private/postgresql.key

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
REDIS_URL=redis://:password@redis.production.internal:6379/0
REDIS_PASSWORD=generate_redis_password_here
REDIS_HOST=redis.production.internal
REDIS_PORT=6379
REDIS_DB=0
REDIS_SSL=true
REDIS_POOL_SIZE=20

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================
# Main Application Secret Key (used for signing)
SECRET_KEY=generate_256_bit_secret_key_here

# JWT Configuration
JWT_ALGORITHM=RS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30
JWT_PRIVATE_KEY_PATH=/app/keys/jwt_private_key.pem
JWT_PUBLIC_KEY_PATH=/app/keys/jwt_public_key.pem

# Privacy-Safe Attribution Hash Salt
HASH_SALT=generate_unique_salt_for_hashing_pii

# Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST_SIZE=20

# Account Security
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=30

# ============================================================================
# EXTERNAL API INTEGRATIONS
# ============================================================================

# Facebook Marketing API
FACEBOOK_APP_ID=your_facebook_app_id
FACEBOOK_APP_SECRET=your_facebook_app_secret
FACEBOOK_ACCESS_TOKEN=your_long_lived_access_token
FACEBOOK_VERIFY_TOKEN=your_webhook_verify_token
FACEBOOK_API_VERSION=v18.0

# Google Ads API
GOOGLE_ADS_DEVELOPER_TOKEN=your_google_ads_developer_token
GOOGLE_ADS_CLIENT_ID=your_google_ads_client_id
GOOGLE_ADS_CLIENT_SECRET=your_google_ads_client_secret
GOOGLE_ADS_REFRESH_TOKEN=your_google_ads_refresh_token
GOOGLE_ADS_CUSTOMER_ID=your_default_customer_id

# Square API
SQUARE_APPLICATION_ID=your_square_application_id
SQUARE_ACCESS_TOKEN=your_square_access_token
SQUARE_WEBHOOK_SIGNATURE_KEY=your_square_webhook_signature_key
SQUARE_ENVIRONMENT=production

# Booksy API (if available)
BOOKSY_API_KEY=your_booksy_api_key
BOOKSY_WEBHOOK_SECRET=your_booksy_webhook_secret

# ============================================================================
# EMAIL AND SMS CONFIGURATION
# ============================================================================
# SendGrid for transactional emails
SENDGRID_API_KEY=your_sendgrid_api_key
SENDGRID_FROM_EMAIL=noreply@bookingbridge.com
SENDGRID_FROM_NAME=BookingBridge

# Twilio for SMS and phone tracking
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+1234567890

# ============================================================================
# MONITORING AND OBSERVABILITY
# ============================================================================
# Sentry for error tracking
SENTRY_DSN=https://your_sentry_dsn@sentry.io/project_id
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# New Relic (optional)
NEW_RELIC_LICENSE_KEY=your_new_relic_license_key
NEW_RELIC_APP_NAME=BookingBridge Production

# DataDog (optional)
DATADOG_API_KEY=your_datadog_api_key
DATADOG_APP_KEY=your_datadog_app_key

# ============================================================================
# FILE STORAGE AND CDN
# ============================================================================
# AWS S3 for file storage
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_S3_BUCKET=bookingbridge-production-files
AWS_S3_REGION=us-east-1
AWS_CLOUDFRONT_DOMAIN=cdn.bookingbridge.com

# ============================================================================
# WEBHOOK CONFIGURATION
# ============================================================================
WEBHOOK_SECRET_KEY=generate_webhook_secret_key
WEBHOOK_TIMEOUT_SECONDS=30
WEBHOOK_MAX_RETRIES=3

# ============================================================================
# FRONTEND CONFIGURATION
# ============================================================================
NEXT_PUBLIC_API_URL=https://api.bookingbridge.com
NEXT_PUBLIC_APP_URL=https://bookingbridge.com
NEXT_PUBLIC_SENTRY_DSN=https://your_frontend_sentry_dsn@sentry.io/project_id
NEXT_PUBLIC_GOOGLE_ANALYTICS_ID=GA-XXXXXXXXX
NEXT_PUBLIC_HOTJAR_ID=your_hotjar_id

# ============================================================================
# CELERY BACKGROUND TASKS
# ============================================================================
CELERY_BROKER_URL=redis://:password@redis.production.internal:6379/1
CELERY_RESULT_BACKEND=redis://:password@redis.production.internal:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true

# ============================================================================
# CORS AND SECURITY HEADERS
# ============================================================================
CORS_ORIGINS=https://bookingbridge.com,https://www.bookingbridge.com
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=86400

# Security Headers
SECURE_SSL_REDIRECT=true
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=true
SECURE_HSTS_PRELOAD=true
SECURE_CONTENT_TYPE_NOSNIFF=true
SECURE_BROWSER_XSS_FILTER=true
SECURE_FRAME_DENY=true

# ============================================================================
# PERFORMANCE AND CACHING
# ============================================================================
# Redis Cache TTL (seconds)
CACHE_DEFAULT_TTL=3600
CACHE_ATTRIBUTION_TTL=1800
CACHE_ANALYTICS_TTL=900

# API Response Compression
ENABLE_GZIP_COMPRESSION=true
GZIP_MINIMUM_SIZE=1024

# ============================================================================
# BACKUP AND DISASTER RECOVERY
# ============================================================================
# Database backup configuration
DB_BACKUP_ENABLED=true
DB_BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
DB_BACKUP_RETENTION_DAYS=30
DB_BACKUP_S3_BUCKET=bookingbridge-production-backups

# ============================================================================
# SCALING AND LOAD BALANCING
# ============================================================================
# Uvicorn workers for production
UVICORN_WORKERS=4
UVICORN_MAX_REQUESTS=1000
UVICORN_MAX_REQUESTS_JITTER=100

# ============================================================================
# FEATURE FLAGS AND TOGGLES
# ============================================================================
ENABLE_REGISTRATION=true
ENABLE_EMAIL_VERIFICATION=true
ENABLE_SMS_VERIFICATION=false
ENABLE_FACEBOOK_PIXEL_INTEGRATION=true
ENABLE_GOOGLE_ADS_INTEGRATION=true
ENABLE_SQUARE_INTEGRATION=true
ENABLE_DEBUG_TOOLBAR=false
ENABLE_API_RATE_LIMITING=true

# ============================================================================
# COMPLIANCE AND PRIVACY
# ============================================================================
# GDPR Compliance
GDPR_ENABLED=true
DATA_RETENTION_DAYS=730  # 2 years
COOKIE_CONSENT_REQUIRED=true

# Privacy settings
ANONYMIZE_IP_ADDRESSES=true
HASH_PII_DATA=true
ENCRYPT_SENSITIVE_DATA=true

# ============================================================================
# MISCELLANEOUS
# ============================================================================
# Timezone
TIMEZONE=UTC

# Pagination defaults
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# Attribution matching thresholds
MIN_ATTRIBUTION_CONFIDENCE=0.6
ATTRIBUTION_WINDOW_DAYS=30

# ============================================================================
# DOCKER COMPOSE OVERRIDES
# ============================================================================
# These are used by docker-compose.production.yml
BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')
VERSION=1.0.0
VCS_REF=$(git rev-parse HEAD)

# Container resource limits
BACKEND_CPU_LIMIT=1.0
BACKEND_MEMORY_LIMIT=2G
FRONTEND_CPU_LIMIT=0.5
FRONTEND_MEMORY_LIMIT=1G
DB_CPU_LIMIT=2.0
DB_MEMORY_LIMIT=4G
REDIS_CPU_LIMIT=0.5
REDIS_MEMORY_LIMIT=1G

# ============================================================================
# MONITORING CREDENTIALS
# ============================================================================
GRAFANA_USER=admin
GRAFANA_PASSWORD=generate_secure_grafana_password

PROMETHEUS_RETENTION_SIZE=10GB
PROMETHEUS_RETENTION_TIME=90d

# ============================================================================
# SSL/TLS CERTIFICATES
# ============================================================================
SSL_CERT_PATH=/etc/ssl/certs/bookingbridge.crt
SSL_KEY_PATH=/etc/ssl/private/bookingbridge.key
SSL_CHAIN_PATH=/etc/ssl/certs/bookingbridge-chain.crt

# ============================================================================
# KUBERNETES SPECIFIC
# ============================================================================
K8S_NAMESPACE=bookingbridge
K8S_SERVICE_ACCOUNT=bookingbridge-sa
K8S_INGRESS_CLASS=nginx

# Resource requests and limits for Kubernetes
K8S_BACKEND_CPU_REQUEST=500m
K8S_BACKEND_CPU_LIMIT=1000m
K8S_BACKEND_MEMORY_REQUEST=1Gi
K8S_BACKEND_MEMORY_LIMIT=2Gi

K8S_FRONTEND_CPU_REQUEST=250m
K8S_FRONTEND_CPU_LIMIT=500m
K8S_FRONTEND_MEMORY_REQUEST=512Mi
K8S_FRONTEND_MEMORY_LIMIT=1Gi

# ============================================================================
# END OF CONFIGURATION
# ============================================================================

# Security reminder:
# 1. Generate strong, unique passwords for all services
# 2. Use environment-specific secrets, never reuse between environments
# 3. Rotate secrets regularly (quarterly recommended)
# 4. Use secret management systems (AWS Secrets Manager, HashiCorp Vault, etc.)
# 5. Monitor for secret exposure in logs or error messages