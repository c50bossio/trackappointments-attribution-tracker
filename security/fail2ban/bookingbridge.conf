# Fail2ban Configuration for BookingBridge
# Protects against brute force attacks and malicious behavior

[DEFAULT]
# Default ban time (24 hours)
bantime = 86400

# Observation window (10 minutes)
findtime = 600

# Maximum retries before ban
maxretry = 5

# Ban action
banaction = iptables-multiport

# Email configuration
destemail = security@bookingbridge.com
sender = security@bookingbridge.com
mta = sendmail

# Action taken when threshold is reached
action = %(action_mwl)s

[bookingbridge-auth]
# Authentication failures
enabled = true
port = http,https
filter = bookingbridge-auth
logpath = /var/log/nginx/access.log
maxretry = 3
bantime = 3600
findtime = 300

[bookingbridge-api-abuse]
# API abuse protection
enabled = true
port = http,https
filter = bookingbridge-api-abuse
logpath = /var/log/nginx/access.log
maxretry = 100
bantime = 1800
findtime = 60

[bookingbridge-dos]
# DoS attack protection
enabled = true
port = http,https
filter = bookingbridge-dos
logpath = /var/log/nginx/access.log
maxretry = 200
bantime = 86400
findtime = 300

[bookingbridge-scanner]
# Security scanner detection
enabled = true
port = http,https
filter = bookingbridge-scanner
logpath = /var/log/nginx/access.log
maxretry = 1
bantime = 604800
findtime = 300

[bookingbridge-sql-injection]
# SQL injection attempts
enabled = true
port = http,https
filter = bookingbridge-sql-injection
logpath = /var/log/nginx/access.log
maxretry = 1
bantime = 86400
findtime = 300

[bookingbridge-xss]
# XSS attack attempts
enabled = true
port = http,https
filter = bookingbridge-xss
logpath = /var/log/nginx/access.log
maxretry = 1
bantime = 86400
findtime = 300