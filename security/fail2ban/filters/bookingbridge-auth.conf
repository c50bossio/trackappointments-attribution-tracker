# Fail2ban filter for BookingBridge authentication failures

[Definition]
# Authentication failure patterns
failregex = ^<HOST> .* "POST /api/v[0-9]+/auth/(login|register)" (401|403|422) .*$
            ^<HOST> .* "POST /api/auth/(login|register)" (401|403|422) .*$

# Ignore successful authentications
ignoreregex = ^<HOST> .* "POST /api/v[0-9]+/auth/(login|register)" 200 .*$
              ^<HOST> .* "POST /api/auth/(login|register)" 200 .*$

# Date pattern
datepattern = ^%%d/%%b/%%Y:%%H:%%M:%%S