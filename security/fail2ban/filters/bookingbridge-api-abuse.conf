# Fail2ban filter for BookingBridge API abuse

[Definition]
# API abuse patterns - too many requests per minute
failregex = ^<HOST> .* "GET /api/.*" (429|503) .*$
            ^<HOST> .* "POST /api/.*" (429|503) .*$
            ^<HOST> .* "PUT /api/.*" (429|503) .*$
            ^<HOST> .* "DELETE /api/.*" (429|503) .*$

# Ignore legitimate API usage
ignoreregex = ^<HOST> .* "GET /api/(health|version)" .*$

# Date pattern
datepattern = ^%%d/%%b/%%Y:%%H:%%M:%%S